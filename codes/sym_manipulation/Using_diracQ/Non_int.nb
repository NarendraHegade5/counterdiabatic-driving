(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27856,        849]
NotebookOptionsPosition[     24688,        767]
NotebookOutlinePosition[     25022,        782]
CellTagsIndexPosition[     24979,        779]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<DiracQV1.m\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.711725234689065*^9},ExpressionUUID->"5d350f18-289d-44dc-89a0-\
e6958963c03e"],

Cell[TextData[{
 "\n",
 StyleBox["Now let' s define non integrable model",
  FontColor->RGBColor[1, 0, 1]]
}], "Input",
 CellChangeTimes->{{3.711725425242199*^9, 3.711725503537738*^9}},
 FormatType->
  "TextForm",ExpressionUUID->"9f05025d-4519-4bc3-b57c-3fec3e5e88b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hamXXZ2Sum", "[", 
   RowBox[{"J_", ",", "h_", ",", "lambdaVar_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "J"}], " ", 
    RowBox[{"(", "    ", 
     RowBox[{
      UnderoverscriptBox[
       RowBox[{"\[Sum]", " "}], 
       RowBox[{"i", "  ", "=", "  ", 
        RowBox[{"-", "5"}]}], "5"], " ", 
      RowBox[{"(", "  ", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", " ", "x"}], "]"}], "**", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", " ", "x"}], "]"}]}], ")"}]}], " ", 
     ")"}]}], "-", 
   RowBox[{"h", "  ", 
    RowBox[{"(", "  ", 
     RowBox[{
      UnderoverscriptBox[
       RowBox[{"\[Sum]", " "}], 
       RowBox[{"i", "  ", "=", "  ", 
        RowBox[{"-", "5"}]}], "5"], 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", " ", "z"}], "]"}]}], ")"}]}], " ", "-", 
   RowBox[{"lambdaVar", " ", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", " ", "x"}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.711725505859058*^9, 3.711725622544703*^9}, 
   3.7117267903085823`*^9, 
   3.711727229503723*^9},ExpressionUUID->"4a893b4a-c276-400f-b8dd-\
c7c809c0ba96"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hamXXZ2Sum", "[", 
  RowBox[{"J", ",", "h", ",", "\[Lambda]"}], "]"}]], "Input",
 CellChangeTimes->{{3.711725645687442*^9, 
  3.7117256569913177`*^9}},ExpressionUUID->"3c3b3056-26d6-4c56-ba88-\
90c3f8654e19"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "J"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "4"}], ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "4"}], ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"0", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"0", ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"1", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"1", ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"2", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"2", ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"3", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"3", ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"4", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"4", ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"5", ",", "x"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"5", ",", "x"}], "]"}], "**", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"6", ",", "x"}], "]"}]}]}], ")"}]}], "-", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "x"}], "]"}]}], "-", 
  RowBox[{"h", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{
       RowBox[{"-", "5"}], ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{
       RowBox[{"-", "4"}], ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{
       RowBox[{"-", "3"}], ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"0", ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"1", ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"2", ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"3", ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"4", ",", "z"}], "]"}], "+", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"5", ",", "z"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.711727234703347*^9},ExpressionUUID->"08d1e669-608e-47c2-994d-\
acd0aa165bc3"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.711726790380987*^9, 3.711726790412652*^9}, 
   3.711727237855208*^9},ExpressionUUID->"c3e78802-5357-4d7e-8e55-\
c2e6a360bb23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cN2Sum", "[", "sigmamat_", "]"}], ":=", 
  RowBox[{"Commutator", "[", 
   RowBox[{
    RowBox[{"hamXXZ2Sum", "[", 
     RowBox[{"J", ",", "h", ",", "\[Lambda]"}], "]"}], ",", " ", "sigmamat"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.711725667521072*^9, 3.7117256684705877`*^9}, {
  3.711726290978587*^9, 3.7117263001055937`*^9}, {3.711726343185549*^9, 
  3.711726343697014*^9}},ExpressionUUID->"ba5a5fea-7da5-4fa5-bc60-\
6c009f879dae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr1", "=", 
  RowBox[{"Nest", "[", 
   RowBox[{"cN2Sum", ",", 
    RowBox[{"-", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"0", ",", "x"}], "]"}]}], " ", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711726323583693*^9, 
  3.711726348385161*^9}},ExpressionUUID->"b48c2f2a-579d-4a49-bd05-\
5eaaf1ccadbe"],

Cell[BoxData[
 RowBox[{"2", " ", "\[ImaginaryI]", " ", 
  RowBox[{"h", "**", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.711727242557452*^9},ExpressionUUID->"97f85788-2ee2-4630-9ec9-\
50f60ed2e9c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr2", "=", 
  RowBox[{"Nest", "[", 
   RowBox[{"cN2Sum", ",", 
    RowBox[{"-", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"0", ",", "x"}], "]"}]}], " ", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711726479921913*^9, 
  3.7117264917106028`*^9}},ExpressionUUID->"eddad53d-de35-4aa1-8825-\
0a94f36c19c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], " ", 
   RowBox[{
    SuperscriptBox["h", "2"], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "x"}], "]"}]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", "J"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", "J"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.7117272504123383`*^9},ExpressionUUID->"a2759e57-d97f-435d-837a-\
6b60260a8154"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr3", "=", 
  RowBox[{"Nest", "[", 
   RowBox[{"cN2Sum", ",", 
    RowBox[{"-", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"0", ",", "x"}], "]"}]}], " ", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711726500190669*^9, 
  3.711726516173455*^9}},ExpressionUUID->"44ea623c-cc62-41b8-b33e-\
92a5692833e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    SuperscriptBox["h", "3"], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"16", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["\[Lambda]", "2"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}]}], "-", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", "J"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}]}]}], "-", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", "J"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"16", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"16", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}], "+", 
  RowBox[{"16", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.7117272578949823`*^9},ExpressionUUID->"5f64064a-2902-4c09-a1d1-\
aa55c1870adb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"TeXForm", "[", "expr2", "]"}]], "Input",
 CellChangeTimes->{{3.711726520295083*^9, 3.711726532684967*^9}, 
   3.711726751961236*^9},ExpressionUUID->"7dd53043-e99b-406d-b428-\
c6decc70eaab"],

Cell["\<\
-4 h^2\\text{**}\\sigma (0,x)+4 (h J)\\text{**}\\sigma \
(-1,x)\\text{**}\\sigma (0,z)+4 (h J)\\text{**}\\sigma (0,z)\\text{**}\\sigma \
(1,x)+4 (h \\lambda
   )\\text{**}\\sigma (0,z)\
\>", "Input",
 CellChangeTimes->{
  3.711727271229628*^9},ExpressionUUID->"b3555cae-8c5a-4033-8ed0-\
afa7dba993fa"],

Cell["", "Input",
 CellChangeTimes->{{3.711726790748209*^9, 3.7117267912092667`*^9}, 
   3.711727267981619*^9},ExpressionUUID->"58a731fd-0dc9-4ddf-a229-\
1cab623c61fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr3", "=", 
  RowBox[{
   RowBox[{"8", " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["h", "3"], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}], "+", 
   RowBox[{"16", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"]}], ")"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}], "+", 
   RowBox[{"8", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["\[Lambda]", "2"]}], ")"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}], "-", 
   RowBox[{"8", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", "J"}], ")"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "y"}], "]"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}]}], "-", 
   RowBox[{"8", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", "J"}], ")"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "y"}], "]"}]}], "+", 
   RowBox[{"16", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"h", " ", "J", " ", "\[Lambda]"}], ")"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}], "+", 
   RowBox[{"16", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"h", " ", "J", " ", "\[Lambda]"}], ")"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}], "+", 
   RowBox[{"16", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"]}], ")"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "*", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.711726754264841*^9, 3.711726767208125*^9}, {
   3.71172680672781*^9, 3.711726807162553*^9}, 
   3.7117272764159937`*^9},ExpressionUUID->"806a1248-0f8d-4189-bc21-\
c567a8f85a77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["h", "3"], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}]}], "+", 
  RowBox[{"16", " ", "\[ImaginaryI]", " ", "h", " ", 
   SuperscriptBox["J", "2"], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}]}], "+", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", "h", " ", 
   SuperscriptBox["\[Lambda]", "2"], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}]}], "+", 
  RowBox[{
  "16", " ", "\[ImaginaryI]", " ", "h", " ", "J", " ", "\[Lambda]", " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "x"}], "]"}], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}]}], "-", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["h", "2"], " ", "J", " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "y"}], "]"}], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "z"}], "]"}]}], "+", 
  RowBox[{
  "16", " ", "\[ImaginaryI]", " ", "h", " ", "J", " ", "\[Lambda]", " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"1", ",", "x"}], "]"}]}], "+", 
  RowBox[{"16", " ", "\[ImaginaryI]", " ", "h", " ", 
   SuperscriptBox["J", "2"], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "x"}], "]"}], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"1", ",", "x"}], "]"}]}], "-", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["h", "2"], " ", "J", " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "z"}], "]"}], " ", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"1", ",", "y"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.711726807927121*^9},ExpressionUUID->"5790a88c-90bc-4948-917b-\
d72641bd45b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "expr3", "]"}]], "Input",
 CellChangeTimes->{{3.7117267838936987`*^9, 3.711726827255047*^9}, 
   3.711727287246402*^9},ExpressionUUID->"9e7f2a8c-599d-4ec8-8b73-\
c511a2f536aa"],

Cell["\<\
8 i h^3\\text{**}\\sigma (0,y)-8 i \\left(h^2 J\\right)\\text{**}\\sigma \
(-1,y)\\text{**}\\sigma (0,z)-8 i \\left(h^2 J\\right)\\text{**}\\sigma
   (0,z)\\text{**}\\sigma (1,y)+16 i \\left(h J^2\\right)\\text{**}\\sigma \
(-1,x)\\text{**}\\sigma (0,y)\\text{**}\\sigma (1,x)+16 i \\left(h
   J^2\\right)\\text{**}\\sigma (0,y)+16 i (h J \\lambda )\\text{**}\\sigma \
(-1,x)\\text{**}\\sigma (0,y)+16 i (h J \\lambda )\\text{**}\\sigma
   (0,y)\\text{**}\\sigma (1,x)+8 i \\left(h \\lambda \
^2\\right)\\text{**}\\sigma (0,y)\
\>", "Output",
 CellChangeTimes->{3.711726827971368*^9, 
  3.711727288013858*^9},ExpressionUUID->"cb4c9c02-4695-47fd-8417-\
8dbbf6d2d405"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"T3", "=", 
   RowBox[{"16", " ", "\[ImaginaryI]", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"h", " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"0", ",", "y"}], "]"}], "**", 
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"1", ",", "x"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.711728674127281*^9, 
  3.711728723969955*^9}},ExpressionUUID->"ebf23eeb-3a6b-49c1-974c-\
8b869ac4fa07"],

Cell[BoxData[
 RowBox[{"16", " ", "\[ImaginaryI]", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"h", " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"0", ",", "y"}], "]"}], "**", 
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"1", ",", "x"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.711728725712988*^9},ExpressionUUID->"e69658b1-a1c4-4d8f-83e6-\
cf27da9575b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Nest", "[", 
   RowBox[{"cN2Sum", ",", "T3", " ", ",", "1"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7117287275392447`*^9, 
  3.711728754035074*^9}},ExpressionUUID->"174abcbc-5410-4854-bc28-\
e3b6eeabe1af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"32", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"], " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}]}]}], "-", 
  RowBox[{"32", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}], "+", 
  RowBox[{"32", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"32", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", "J", " ", 
      SuperscriptBox["\[Lambda]", "2"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}], "+", 
  RowBox[{"32", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"], " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.7117287439319763`*^9},ExpressionUUID->"93880a90-84be-4a80-a08c-\
d41015bb16ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Nest", "[", 
    RowBox[{"cN2Sum", ",", "T3", " ", ",", "2"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.711728745696453*^9, 
  3.711728761007649*^9}},ExpressionUUID->"9e14094d-99ba-464b-ab88-\
211b94b8c715"],

Cell[BoxData[
 RowBox[{
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"], " ", 
      SuperscriptBox["\[Lambda]", "2"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "3"], " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "3"], " ", "J", " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}], "+", 
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "3"], " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "3"], " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}], "-", 
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", "J", " ", 
      SuperscriptBox["\[Lambda]", "2"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "y"}], "]"}]}]}], "+", 
  RowBox[{"64", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", "J", " ", 
      SuperscriptBox["\[Lambda]", "3"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}], "-", 
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", 
      SuperscriptBox["J", "2"], " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "y"}], "]"}]}]}], "-", 
  RowBox[{"64", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", 
      SuperscriptBox["J", "2"], " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}], "-", 
  RowBox[{"64", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["h", "2"], " ", 
      SuperscriptBox["J", "2"], " ", "\[Lambda]"}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "z"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"2", ",", "x"}], "]"}]}]}], "+", 
  RowBox[{"128", " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", " ", 
      SuperscriptBox["J", "2"], " ", 
      SuperscriptBox["\[Lambda]", "2"]}], ")"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "x"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"0", ",", "y"}], "]"}], "**", 
    RowBox[{"\[Sigma]", "[", 
     RowBox[{"1", ",", "x"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.711728763102392*^9},ExpressionUUID->"ae9550bf-bb27-4d46-814f-\
223f889d7778"]
}, Open  ]]
},
WindowSize->{1280, 975},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 302, 8, 57, "Input", "ExpressionUUID" -> \
"5d350f18-289d-44dc-89a0-e6958963c03e"],
Cell[863, 30, 268, 7, 50, "Input", "ExpressionUUID" -> \
"9f05025d-4519-4bc3-b57c-3fec3e5e88b7"],
Cell[1134, 39, 1223, 36, 64, "Input", "ExpressionUUID" -> \
"4a893b4a-c276-400f-b8dd-c7c809c0ba96"],
Cell[CellGroupData[{
Cell[2382, 79, 232, 5, 34, "Input", "ExpressionUUID" -> \
"3c3b3056-26d6-4c56-ba88-90c3f8654e19"],
Cell[2617, 86, 3414, 105, 80, "Output", "ExpressionUUID" -> \
"08d1e669-608e-47c2-994d-acd0aa165bc3"]
}, Open  ]],
Cell[6046, 194, 175, 3, 32, InheritFromParent, "ExpressionUUID" -> \
"c3e78802-5357-4d7e-8e55-c2e6a360bb23"],
Cell[6224, 199, 476, 11, 34, "Input", "ExpressionUUID" -> \
"ba5a5fea-7da5-4fa5-bc60-6c009f879dae"],
Cell[CellGroupData[{
Cell[6725, 214, 339, 9, 34, "Input", "ExpressionUUID" -> \
"b48c2f2a-579d-4a49-bd05-5eaaf1ccadbe"],
Cell[7067, 225, 259, 7, 34, "Output", "ExpressionUUID" -> \
"97f85788-2ee2-4630-9ec9-50f60ed2e9c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7363, 237, 341, 9, 34, "Input", "ExpressionUUID" -> \
"eddad53d-de35-4aa1-8825-0a94f36c19c0"],
Cell[7707, 248, 994, 33, 36, "Output", "ExpressionUUID" -> \
"a2759e57-d97f-435d-837a-6b60260a8154"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8738, 286, 339, 9, 34, "Input", "ExpressionUUID" -> \
"44ea623c-cc62-41b8-b33e-92a5692833e2"],
Cell[9080, 297, 2359, 71, 71, "Output", "ExpressionUUID" -> \
"5f64064a-2902-4c09-a1d1-aa55c1870adb"]
}, Open  ]],
Cell[11454, 371, 213, 4, 32, "Input", "ExpressionUUID" -> \
"7dd53043-e99b-406d-b428-c6decc70eaab"],
Cell[11670, 377, 311, 8, 66, InheritFromParent, "ExpressionUUID" -> \
"b3555cae-8c5a-4033-8ed0-afa7dba993fa"],
Cell[11984, 387, 168, 3, 32, InheritFromParent, "ExpressionUUID" -> \
"58a731fd-0dc9-4ddf-a229-1cab623c61fb"],
Cell[CellGroupData[{
Cell[12177, 394, 2363, 65, 71, "Input", "ExpressionUUID" -> \
"806a1248-0f8d-4189-bc21-c567a8f85a77"],
Cell[14543, 461, 1903, 51, 60, "Output", "ExpressionUUID" -> \
"5790a88c-90bc-4948-917b-d72641bd45b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16483, 517, 215, 4, 32, InheritFromParent, "ExpressionUUID" -> \
"9e7f2a8c-599d-4ec8-8b73-c511a2f536aa"],
Cell[16701, 523, 676, 12, 104, "Output", "ExpressionUUID" -> \
"cb4c9c02-4695-47fd-8417-8dbbf6d2d405"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17414, 540, 497, 13, 56, "Input", "ExpressionUUID" -> \
"ebf23eeb-3a6b-49c1-974c-8b869ac4fa07"],
Cell[17914, 555, 399, 11, 34, "Output", "ExpressionUUID" -> \
"e69658b1-a1c4-4d8f-83e6-cf27da9575b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18350, 571, 269, 7, 56, "Input", "ExpressionUUID" -> \
"174abcbc-5410-4854-bc28-e3b6eeabe1af"],
Cell[18622, 580, 1621, 50, 71, "Output", "ExpressionUUID" -> \
"93880a90-84be-4a80-a08c-d41015bb16ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20280, 635, 306, 8, 78, "Input", "ExpressionUUID" -> \
"9e14094d-99ba-464b-ab88-211b94b8c715"],
Cell[20589, 645, 4083, 119, 164, "Output", "ExpressionUUID" -> \
"ae9550bf-bb27-4d46-814f-223f889d7778"]
}, Open  ]]
}
]
*)

