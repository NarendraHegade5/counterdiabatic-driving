\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[hmargin=2.0cm,vmargin=2.5cm,bindingoffset=0.5cm]{geometry}
\usepackage{amsfonts}
\usepackage{amsmath,amsthm,amssymb}
\allowdisplaybreaks
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{mathtools}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
%\usepackage{float}
\usepackage{placeins}
\usepackage{diagbox}
\DeclareMathOperator{\Tr}{Tr}
\newtheorem{thm}{Theorem}
\usepackage{subcaption}
%\usepackage{subfigure}
\usepackage[english]{babel}
\author{Mohit}
\title{Approximate adiabatic gauge potential of non-integrable systems  }
\begin{document}
\maketitle
%\tableofcontents

\section{Introduction}

Adiabatic gauge potentials are useful for controlling a quantum system when it's driven externally from one configuration to another. These potentials help us in  circumventing standard adiabatic limitations which requires infinitesimally small rates \cite{demirplak2003adiabatic,demirplak2005assisted, berry2009transitionless}. For example, these potentials can be used for arbitrarily fast annealing protocols and implementing fast dissipationless driving. 



The scaling of norm of gauge potential with system's size is quite different for  quantum integrable and non-integrable systems. On one hand, for integrable systems , exact gauge potential are supposed to scale like a polynomial in system size. This is due to extensive number of symmetries that exist and as a result, they have a ``lot" of degenerate energy levels which comes with their respective ``selection rules".  This can be easily seen  for Transverse Ising model whose analytical expression of gauge potential is known in literature.

On the other hand, for non-integrable systems, using  Eigenstate Thermalization Hypothesis (ETH)\cite{d2016quantum} , we can show that norm of exact gauge potential scale exponentially in system size. This can be verified numerically using exact diagonalization on spin system upto size $L=15$. 


We can exploit this property to distinguish  between quantum integrable and non-integrable system. Our method should be better than conventional method (energy level distribution) used in literature for this purpose because unlike the conventional method, we don't have to worry about removing symmetry.


%The goal, as of now, is to distinguish between integrable and non-integrable many-body quantum system by studying their approximate gauge adiabatic potential\footnote{We expect results to be valid for classical system too. But for now, we would focus on quantum systems.}

 



\section{Adiabatic gauge potential}
\subsection{Introduction by example}


\begin{equation}
H_0= \dfrac{p^2}{2m} + V(x- \lambda(t))
\end{equation}

\begin{align*}
H_{CD}= H_0 + \dot{\lambda} A_{\lambda}
\end{align*}
where $A_{\lambda}= p$.
Include a picture of glass of water being transported from Dries's PNAS paper. Question: if you have exact gauge potential, does all the excitations during intermediate times is zero.

\subsection{Formal introduction}
Adiabatic gauge potentials are the generators of a unitary transformation which diagonalize the instantaneous Hamiltonian, attempting to leave its eigenbasis invariant as the parameter is changed. These adiabatic gauge potentials generate \textit{non-adiabatic} corrections to Hamiltonian in the moving basis ($\lambda$ -dependent basis).
 
 This is something from Anatoli's lecture notes \cite{kolodrubetz2016geometry}--
``an adiabatic basis is a family of adiabatically connected eigenstates, i.e., eigenstates related
to a particular initial basis by adiabatic (infinitesimally slow) evolution of the parameter $\lambda$. For example, if two levels cross they will exchange order energetically but the adiabatic connection will be non-singular."


$H (\lambda) |n(\lambda) \rangle = E_n (\lambda) |n(\lambda) $. Let's derive diagonal and off-diagonal elements. 


\begin{itemize}
\item \textbf{n-th diagonal element:} $A_{\lambda}^n= \langle n |A_{\lambda} | n \rangle=  i \hbar\langle n |\partial_{\lambda} | n \rangle $
\item \textbf{off- diagonal element:} We use the identity $\langle m |H(\lambda) | n \rangle=0 \quad, n \neq m$ and then differentiate with respect to $\lambda$ to obtain:
\begin{align}
\boxed{\langle m |A_{\lambda} | n \rangle =  -i \hbar \dfrac{\langle m |\partial_{\lambda}H | n \rangle}{E_m-E_n}}
\end{align}
where both  energies ($E_m, E_n$) and eigenvectors ($|m \rangle, |n \rangle$) depend on $\lambda$.
\end{itemize}







\subsection{Eigenstate Thermalization Hypothesis}
Eigenstate Thermalization Hypothesis( ETH) gives us an ansatz for matrix elements of observables in the basis of energy eigenstates  \cite{d2016quantum}:
\begin{equation}
O_{mn}= O( \bar{E}) \delta_{mn} + e^{-S(\bar{E})/2} f_O(\bar{E}, \omega) R_{mn}
\end{equation}
where $\bar{E}= (E_m +E_n)/2, \omega= E_n- E_m$ and $S(E)$ is the thermodynamic entropy at energy $E$.

We note that it's applicable only for few-body operators of a non-integrable Hamiltonian. By few-body, we mean $n$ body observables with $n \ll N$, where $N$ is the total number of spins, particles, etc. For example, projection operator to eigenstates of many body  Hamiltonian $\hat{P}_{\alpha}= |\Psi_{\alpha} \rangle \langle\Psi_{\alpha}  |$ don't satisfy ETH and it also doesn't satisfy predictions of statistical mechanics. Why is that? We expect that microcanonical averaging should be equivalent to canonical averaging:
\begin{equation}
 \langle\Psi_{\alpha}  |O|\Psi_{\alpha} \rangle= \dfrac{\Tr O e^{-\beta H}}{\Tr e^{-\beta H}}
\end{equation}
We can see $O= \hat{P}_{\alpha}$ doesn't satisfy the above equation (since left hand side is one and the trace of right hand side can be computed in energy basis to find that it's not one). Projection operator is non-local in real space, and we argue that this is the reason it doesn't satisfy ETH and is not experimentally measurable.

\subsubsection{Information about $f_O(\bar{E}, \omega)$}

\begin{equation}
 |f_O(\bar{E}, \omega)|=\left\{
  \begin{array}{@{}ll@{}}
    e^{-\omega T} & (\omega \gg T), \\
     \dfrac{\sqrt{L}}{\omega^2+ \mu_T^2} & (\omega \ll T)
  \end{array}\right.
\end{equation}
where $\mu_T \sim \dfrac{1}{L^2}$ \cite{khatami2013fluctuation, srednicki1999approach,d2016quantum}

\section{Norm of adiabatic gauge potential}
Let's compute the norm by noting that $A_{\lambda}$ has only off-diagonal elements in energy basis in our gauge choice:

\begin{align}
||A_{\lambda}||^2 &= \Tr  A_{\lambda}^2 \\
&= \sum_n \langle n | A^2_{\lambda}| n \rangle \\
&= \sum_{n} \langle n | A_{\lambda}| n \rangle ^2 + \sum_n \sum_{m \neq n}  |\langle m | A_{\lambda}| n \rangle|^2 \\
&=  \sum_n \sum_{m \neq n}  |\langle m | A_{\lambda}| n \rangle|^2 \\
&= \hbar^2 \sum_n \sum_{m \neq n}  \dfrac{|\langle m | \partial_{\lambda}H| n \rangle|^2}{(E_m-E_n)^2} 
\end{align}

Hence, in general, for both integrable and non-integrable systems we have: 
\begin{equation}
\boxed{||A_{\lambda}||^2 = \hbar^2\sum_n \sum_{m \neq n}  \dfrac{|\langle m | \partial_{\lambda}H| n \rangle|^2}{(E_m-E_n)^2} }
\end{equation}


\section{Integrable model}
Our goal is to study a integrable model, which is called \textbf{Transverse Field Ising model}. It shows quantum phase transition between ferromagnetic and paramagnetic phases. Moreover, it satisfies Ising symmetry $G= \Pi_i \sigma_i^z$ since $[H, G]=0$, where $H$ is the Hamiltonian.
This model can be written in terms of non-interacting spinless fermions ($c_i, c^{\dagger}_i $) using Jordan- Wigner transformation. 

It's Hamiltonian in spin basis is given by:
\begin{equation}
H= -J \sum_{j=1}^{L} \sigma_j^x \sigma_{j+1}^x - \lambda \sum_{j} \sigma_j^z 
\label{xx_z}
\end{equation}
where we have chosen periodic boundary conditions and $\lambda$ is externally-controlled transverse magnetic field.

This model can be written in terms of non-interacting spinless fermions ($c_i, c^{\dagger}_i $) using Jordan- Wigner transformation: $\sigma_i^z \sim 1 - 2 c^{\dagger}_i c_i   $ and $\sigma_i^+ \sim \prod_{j<i} \sigma_j^z c_j   $. Details can be found elsewhere \cite{sachdev2007quantum} \footnote{Momentum operator chosen to get real valued Hamiltonian is $c_k= \frac{e^{i \pi/4}}{\sqrt{L}}\sum_j c_j e^{-ikj}$, where k is $n\pi/L$ with $n=0,1,2, \ldots L-1$} . Here is what we get after this transformation:

\begin{equation}
\mathcal{H}= \sum_k \psi_k^{\dagger} H_k \psi_k , \quad H_k=-\begin{bmatrix}
     \lambda - \cos k & \sin k \\
\sin k & -(\lambda - \cos k)\\
\end{bmatrix}
\end{equation}
where $\psi_k^{\dagger}= (c^{\dagger}_k, c_{-k})$ is Nambu spinor basis. We can write $H_k$ in terms of Pauli sigma matrices:
\begin{equation}
H_k= -(\lambda - \cos k) \sigma^z_k - \sin k  \sigma^x_k
\end{equation}



Now using our regulator method (whose details are not given in this report), we can obtain :
\begin{equation}
\boxed{A_{\lambda}= \sum_{l=1}^{L-1} \alpha_l O_l \quad \mbox{where} \quad \alpha_l= -\dfrac{1}{4 L} \sum_k \dfrac{\sin(k) \sin(lk)}{(\cos k - \lambda)^2 + \sin^2 k}}
\end{equation}
where  $O_l$ is given by
\begin{equation}
O_l= 2 i \sum_j (c^{\dagger}_{j} c^{\dagger}_{j+l} - \mbox{h.c})= \sum_j ( \sigma_j^x \sigma_{j+1}^z \ldots \sigma_{j+l-1}^z \sigma_{j+l}^y +  \sigma_j^y \sigma_{j+1}^z \ldots \sigma_{j+l-1}^z \sigma_{j+l}^x)
\end{equation}
This matches with the result already known in literature \cite{del2012assisted, kolodrubetz2016geometry}.


Let's write a first few terms of $O_l$ here:
\begin{align*}
O_{l=1}&=  \sum_{j=1}^{L} ( \sigma_j^x  \sigma_{j+1}^y +  \sigma_j^y  \sigma_{j+1}^x) \\
O_{l=2} &=  \sum_{j=1}^{L} ( \sigma_j^x \sigma_{j+1}^z \sigma_{j+2}^y +  \sigma_j^y \sigma_{j+1}^z \sigma_{j+2}^x) 
\end{align*}

On computation, we find that with periodic boundary conditions, we get $\Tr O_l  O_p= \delta_{l,p} 2^{L+1} L$

For large enough system size $L$, we can compute $\alpha_l$ \cite{kolodrubetz2016geometry} by computing the sum into an integral and obtain the value of $\alpha_l$ as: 
\begin{equation}
 \alpha_l=-\dfrac{1}{8}\left\{
  \begin{array}{@{}ll@{}}
    \lambda^{l-1} & (\lambda^2 <1), \\
     \lambda^{-l-1} & (\lambda^2 >1)
  \end{array}\right.
\end{equation}




\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.52]{new_pics/alpha_num_theoret.eps}
\includegraphics[scale=0.52]{new_pics/error_alpha.eps}
\caption{Integrable systems: string length of exact gauge potential as a function of system size }
\end{center}
\end{figure}

Let's compute norm of gauge potential:
\begin{align}
||A_{\lambda}||^2 &= \Tr  A_{\lambda}^2 \\
&= \Tr \sum_{l,p}  \alpha_p \alpha_l O_l  O_p\\
&=  \sum_{l,p}  \alpha_p \alpha_l  \Tr O_l  O_p\\
&=  2^{L+1} L \sum_{l=1}^{L-1}   \alpha_l ^2
\end{align}

\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.52]{new_pics/OBC_int_comparing_num_anal_norm_L_scaling.eps}
\includegraphics[scale=0.52]{new_pics/PBC_int_comparing_num_anal_norm_L_scaling.eps}
\caption{Integrable systems: Norm of exact gauge potential as a function of system size }
\end{center}
\end{figure}



Now since $\alpha_l$ for large enough $L$ is exponentially suppressed in $l$, we can argue that


\begin{equation}
\boxed{||A_{\lambda}||^2 / 2^L \sim 2 L }
\end{equation}

\section{Non-integrable model}

If we introduce longitudinal magnetic field in Transverse Ising model, then integrability is broken and we get a non-integrable model. We plan to study both local  and global integrability-breaking term. 

\begin{equation}
H= -J \sum_{j=1}^{L-1} \sigma_j^x \sigma_{j+1}^x - h\sum_{j=1}^{L} \sigma_j^z -\lambda \sum_{j=1}^{L}\sigma_j^x 
\end{equation}
In this model, $\partial_{\lambda}H = - \sum_{j} \sigma_j^x  $ is a global operator.


\begin{equation}
H= -J  \sum_{j=1}^{L-1} \sigma_j^x - h \sum_{j=1}^{L}  \sigma_j^z -\lambda  \sigma_0^x 
\end{equation}
In this model, $\partial_{\lambda}H = -  \sigma_0^x  $ is a local operator.


\subsection{ETH applied to norm}
$\partial_{\lambda}H$ may or may not be a local operator. We are studying such non-integrable models in which it is a local operator or it's composed by adding local operators. Hence, we can apply ETH on the operator $\partial_{\lambda}H$.

\subsubsection{Heuristic argument}
\begin{align*}
||A_{\lambda}||^2= \hbar^2\sum_n \sum_{m \neq n}  \dfrac{|\langle m | \partial_{\lambda}H| n \rangle|^2}{\omega_{mn}^2}
\end{align*}
where $\omega_{mn}= E_m-E_n$.
We would argue that the biggest contribution to norm would come from the smallest $\omega_{mn}$ because it's exponentially small in system size. Hence, we find that using ETH for  $\partial_{\lambda}H$:

\begin{align*}
||A_{\lambda}||^2&= \hbar^2\sum_n \sum_{m \neq n}  \dfrac{|\langle m | \partial_{\lambda}H| n \rangle|^2}{\omega_{mn}^2}\\
&= \hbar^2\sum_n \sum_{m \neq n}  \dfrac{ e^{-S}}{e^{-2S}} \\
&= \hbar^2\sum_n \sum_{m \neq n}  e^{S} \\
& \simeq \hbar^2 2^L  e^{L} 
\end{align*}
where we have used the fact that entropy is extensive, i.e. $S \sim L$. Hence, norm averaged over system size is exponential in system size with $\hbar=1$
\begin{equation}
\boxed{||A_{\lambda}||^2/ 2^L \sim  e^{L} 
}
\end{equation}

Exponential scaling with system size of gauge potential is due to exponential small eigenvalues. Since these eigenvalues appear in the denominator of gauge potential expression, it's called \textbf{small denominator problem} in literature \cite{kolodrubetz2016geometry}. 

In Dries's notes, you would find how we are attempting to solve this problem.

\subsubsection{Formal calculation}
For formal calculation, I would need to introduce a cutoff $\mu$. Otherwise, norm diverges in thermodynamic limit $L \rightarrow \infty$, which is clear from above heuristic arguments.

\begin{eqnarray}
\langle n | A_{\lambda} | m \rangle &=& \lim_{\mu \rightarrow 0} \lim_{L \rightarrow \infty } -i \hbar \dfrac{\langle n | \partial_{\lambda}H  | m \rangle}{(E_n-E_m)^2 + \mu^2} (E_n-E_m) 
\label{off-digonal}
\end{eqnarray}
where we have chosen a gauge choice in which diagonal elements are zero in energy basis, i.e. $A_{\lambda}^{nn}=0$. 

\begin{equation}
||A_{\lambda}||^2 = \hbar^2\sum_n ||A_{\lambda}||^2_{n}
\end{equation}
where $||A_{\lambda}||^2_{n} =\sum_{m \neq n}  \dfrac{(E_m-E_n)^2}{((E_m-E_n)^2 + \mu^2)^2} |\langle m | \partial_{\lambda}H| n \rangle|^2$.

Let's simplify this using ETH:
\begin{align*}
||A_{\lambda}||^2_{n} &= \sum_{m \neq n}  \dfrac{(E_m-E_n)^2}{((E_m-E_n)^2 + \mu^2)^2} |\langle m | \partial_{\lambda}H| n \rangle|^2\\
&=\sum_{m \neq n}  \dfrac{\omega_{nm}^2}{(\omega_{nm}^2 + \mu^2)^2} e^{-S(\bar{E})} |f_O(\bar{E}, \omega_{nm}) R_{mn}|^2\\
&=\sum_{m \neq n}  \dfrac{\omega_{nm}^2}{(\omega_{nm}^2 + \mu^2)^2} e^{-S(E_n -\omega_{nm}/2)} |f_O(E_n - \omega_{nm}/2, \omega_{nm})|^2 |R_{mn}|^2
\end{align*}
where $\bar{E}= (E_m +E_n)/2=E_n - \omega/2$, $\omega_{nm}= E_n- E_m$ and $S(E)$ is the thermodynamic entropy at energy $E$.
We would need to convert the sum into integral where we use the fact that function $f_O$ is smooth and fluctuations of $|R_{mn}|^2$ average out in the sum.

\begin{equation}
\sum_{m \neq n}  \rightarrow \int d \omega \Omega(E_{n}- \omega)= \int d \omega e^{S(E_{n}- \omega)}
\end{equation}
where $\Omega(E_{n}+ \omega)$ is density of states.


\begin{align*}
||A_{\lambda}||^2_{n} &=\int d \omega e^{S(E_{n}- \omega)-S(E_n -\omega/2)} \dfrac{\omega^2}{(\omega^2 + \mu^2)^2}  |f_O(E_n - \omega/2, \omega)|^2 
\end{align*}
$S(E_{n}- \omega)-S(E_n -\omega/2) = -\beta \omega/2 + \ldots $ and $f_O(E_n - \omega/2, \omega)=f_O(E_n, \omega) + \ldots $ we have

\begin{align*}
||A_{\lambda}||^2_{n} &=\int_a^{b} d \omega e^{-\beta \omega/2} \dfrac{\omega^2}{(\omega^2 + \mu^2)^2}  |f_O(E_n, \omega)|^2 
\end{align*}
where $a$ represents the minimum energy difference $E_m-E_n$ in thermodynamic limit (which is $\min\{w_{nm}\}$) and $b$ is the maximum energy difference (for which we have to find $m$-th state such that we get $\max\{w_{nm}\}$) ). $a= e^{-S} \sim e^{-\delta L}$ and $b= \gamma L$, where $\gamma$ and $\delta$ are constants that depend on the details of Hamiltonian.

Let's denote $I=e^{-\beta \omega/2} \dfrac{\omega^2}{(\omega^2 + \mu^2)^2}$ and find out how it depends on L. First, we check on upper limit.

\begin{align*}
\lim_{L \rightarrow \infty}I(\omega=L)=\lim_{L \rightarrow \infty} e^{-\beta L/2} \dfrac{L^2}{(L^2 + \mu^2)^2} \rightarrow 0
\end{align*}
Now on lower limit.
\begin{align*}
\lim_{L \rightarrow \infty}I(\omega=e^{-L})=\lim_{L \rightarrow \infty} e^{-\beta e^{-L}/2} \dfrac{e^{-2L}}{(e^{-2L} + \mu^2)^2}=\lim_{L \rightarrow \infty} \dfrac{e^{-2L}}{(e^{-2L} + \mu^2)^2}
\end{align*}

\begin{equation}
  \lim_{L \rightarrow \infty}I(\omega=e^{-L})=\left\{
  \begin{array}{@{}ll@{}}
    e^{2L} & (\mu^2 \ll e^{-2L}), \\
     \dfrac{e^{-2L}}{ \mu^4} & (\mu^2 \gg e^{-2L})
  \end{array}\right.
\end{equation}

Now, let's compute the norm while assuming $ |f_O(E_n, \omega)|^2 $ is a constant in $\omega$. Hence, we get:
\begin{align*}
||A_{\lambda}||^2_{n} &=  |f_O(E_n)|^2 \int_0^{\infty} d \omega e^{-\beta \omega/2} \dfrac{\omega^2}{(\omega^2 + \mu^2)^2} 
\end{align*}
Let's assume $\beta \ll 1$ (high temperature limit):

\begin{align*}
||A_{\lambda}||^2_{n} &=  |f_O(E_n)|^2 \int_0^{\infty} d \omega \left(1-\beta \omega/2 + \ldots \right) \dfrac{\omega^2}{(\omega^2 + \mu^2)^2}  \\
&=|f_O(E_n)|^2\left(\dfrac{\pi}{4 \mu}-\dfrac{\beta }{4}-\dfrac{\beta }{4} \log (\mu^2+ \omega^2)|_0^{\infty}  + \ldots \right) \\
\end{align*}

We see that there is a logarithmic divergence for high temperature limit. We also note that there are two limits, in which we find that there is no ultraviolet divergence: $\beta =0$ limit gives $\pi/ 4 \mu$ and $\beta \rightarrow \infty$ limit gives us zero norm. I don't understand why zero temperature limit gives zero norm.


Hence, ETH claims that norm of gauge potential in infinite temperature will be ($\hbar=1$):
\begin{align*}
||A_{\lambda}||^2 &= \sum_n ||A_{\lambda}||^2_{n} \\
&= \dfrac{\pi}{4 \mu} \sum_n |f_O(E_n)|^2\\
&= \dfrac{\pi 2^L}{4 \mu} \langle |f_O(E_n)|^2  \rangle
\end{align*}
Hence, we get:
\begin{equation}
\boxed{
\dfrac{||A_{\lambda}||^2} {2^L}= \dfrac{\pi }{4 \mu} \langle |f_O(E_n)|^2  \rangle}
\end{equation}



\section{System-size scaling of minimum and maximum of $\omega_{ij}$}
For integrable model, we would study the Hamiltonian of Transverse Field Ising model:
%\begin{equation}
%H= J \sum_{j} \sigma_j^z(\sigma_{j+1}^z+ \sigma_{j-1}^x) + \lambda \sum_{j} \sigma_j^z 
%\end{equation}

%and this:
\begin{equation}
H= J \sum_{j=1}^{L-1} \sigma_j^z \sigma_{j+1}^z + \lambda \sum_{j} \sigma_j^x
\end{equation}

%\begin{equation}
%H= J \sum_{j=1}^L-1 \sigma_j^z(\sigma_{j+1}^z+ \sigma_{j-1}^z) + \lambda \sum_{j} \sigma_j^x
%\end{equation}

where we have chosen $J=1$ and $\lambda=5$ with open boundary conditions.

For non-integrable model, we would study the Hamiltonian of Ising model with both transverse and longitudinal fields:
\begin{equation}
H= J \sum_{j=1}^{L-1} \sigma_j^z \sigma_{j+1}^z + h\sum_{j} \sigma_j^z +\lambda \sum_{j} \sigma_j^x 
\end{equation}
%
%\begin{equation}
%H= J \sum_{j} \sigma_j^z (\sigma_{j+1}^z+ \sigma_{j-1}^z) + h\sum_{j} \sigma_j^z +\lambda \sum_{j} \sigma_j^x 
%\end{equation}
where we have chosen $J=1$, $h= (\sqrt{5}+1)/4$ and $\lambda=(\sqrt{5}+5)/8$ with open boundary conditions. These are values of parameters for which this model has been shown to be robustly non-integrable for small systems \cite{kim2013ballistic}. Since anti-ferromagnetic phase has more local order compared to ferromagnetic phase, we expect the former to be less affected by finite size effects.

We see that $\partial_{\lambda}H =  \sum_{j} \sigma_j^x  $.


\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.53]{new_pics/v2_maxwij_int.eps}
\includegraphics[scale=0.53]{new_pics/v2_maxwij_nonint.eps}
\caption{Using ED method, $\max \omega_{ij}(L)$ shows linear scaling with system size}
\label{max_wij}
\end{center}
\end{figure}

 
Below we use exact diagonalization (ED) to compute $\max \omega_{ij} $ and $\min \omega_{ij}$ as a function of system size. As expected for both non-integrable and integrable systems, we find that $\max \omega_{ij} \sim L$ (figure \ref{max_wij}). For non-integrable system, we find $\min \omega_{ij} \sim e^{-L}$ (right side of figure \ref{min_wij}). For integrable systems, since we are using open boundary conditions (which means there is no symmetry of translation in the system), we find that there is no degeneracies for system size checked upto $L=10$. This can explain why we get the same exponential behavior for this system (left side of figure \ref{min_wij}).
 
 
\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.535]{new_pics/v2_minwij_int.eps}
\includegraphics[scale=0.535]{new_pics/v2_minwij_nonint.eps}
\caption{Using ED method,  $\min \omega_{ij}(L)$ shows exponential scaling with system size}
\label{min_wij}
\end{center}
\end{figure} 

We should note that in an integrable system with open boundary condition, exact gauge potential shows an almost linear scaling with system size (figure \ref{exact_regime}). This shows that there are a lot of energy levels in which $ \langle n |\partial_{\lambda}H| m \rangle$ should be zero compared to non-integrable where there are very few degeneracies and very few levels in which $ \langle n |\partial_{\lambda}H| m \rangle$ is zero.
 










\section{Norm computed using ED}

Let's look at the expression of off-diagonal elements of gauge potential:
\begin{equation}
\langle m |A_{\lambda} | n \rangle =  -i \hbar \dfrac{\langle m |\partial_{\lambda}H | n \rangle}{E_m-E_n}, \quad n \neq m
\end{equation}
We see that while using ED, we need to be wary of degenerate eigenvalues. Do these degenerate eigenvalues contribute to norm of gauge potential? Answer is no because $\langle m |\partial_{\lambda}H | n \rangle=0$ for degenerate pair of eigenvalues as shown in appendix \ref{sec.deg}.



%We have two options while computing norm using ED: either take out all degenerate eigenvalues and work in non-degenerate eigen-subspace or introduce a cutoff $\mu$ to help us out here. We find that second option is easier to work numerically. Our $\mu$-dependent gauge potential is given by:
%\begin{equation}
%\langle m |A_{\lambda} | n \rangle =  -i \hbar \dfrac{\langle m |\partial_{\lambda}H | n \rangle}{\omega_{mn}^2+ \mu^2} \omega_{mn}
%\end{equation}
%We note that for $\mu \neq 0$, $A_{\lambda}$ is zero for degenerate levels $n$ and $m$. What should be the value of $\mu$ chosen?  If $\mu^2 \ll \omega_{mn}^2$, then we would be back to square one because then we can ignore $\mu^2$ in denominator, and then the computer would complain of division by zero problem for degenerate levels $n$ and $m$. If $\mu^2 \gg \omega_{mn}^2$, then we would get approximate gauge potential, not the exact one. Numerically, we choose $\mu^2$ to be the difference between two closest floating point numbers.

%We would be studying integrable model, and seeing how norm of gauge potential scales.
%\begin{equation}
%H= -J \sum_{j} \sigma_j^x(\sigma_{j+1}^x+ \sigma_{j-1}^x) - \lambda \sum_{j} \sigma_j^z 
%\end{equation}
%where we have chosen $J=1$ and $\lambda=5$ with open boundary conditions.
%
%\begin{equation}
%H= -J \sum_{j} \sigma_j^x (\sigma_{j+1}^x+ \sigma_{j-1}^x) - h\sum_{j} \sigma_j^z -\lambda \sum_{j} \sigma_j^x 
%\end{equation}
%where we have chosen $J=1$, $h= (\sqrt{5}+1)/4$ and $\lambda=(\sqrt{5}+5)/8$ with open boundary conditions.


%\begin{figure}
%\begin{center}
%%\includegraphics[scale=0.65]{norm.eps}\\
%\includegraphics[scale=0.65]{norm_integ.eps}
%\caption{System size (L) scaling of norm of gauge potential in integrable and non-integrable systems}
%\end{center}
%\end{figure}
%
%
%\begin{figure}
%\begin{center}
%%\includegraphics[scale=0.65]{norm.eps}\\
%\includegraphics[scale=0.65]{norm_mu_scaling_all_L.eps}
%\caption{$\mu$ scaling of norm of gauge potential in integrable and non-integrable systems}
%\end{center}
%\end{figure}
%
%
%
%\begin{figure}
%\begin{center}
%\includegraphics[scale=0.53]{norm_mu_scaling_L8.eps}
%\includegraphics[scale=0.53]{norm_mu_scaling_L10.eps}\\
%\includegraphics[scale=0.67]{norm_mu_scaling_L12.eps}
%\caption{$\mu$ scaling of norm of gauge potential in integrable and non-integrable systems}
%\end{center}
%\end{figure}







\subsection{$\mu$ scaling of gauge potential}




Our $\mu$-dependent gauge potential $A_{\lambda}$ is given by:
\begin{equation}
\langle m |A_{\lambda} | n \rangle =  -i \hbar \dfrac{\langle m |\partial_{\lambda}H | n \rangle}{\omega_{mn}^2+ \mu^2} \omega_{mn}
\end{equation}
where $\omega_{nm}=E_n-E_m$ and eigenstates depend on $\lambda$, i.e.$|n \rangle= |n (\lambda) \rangle $. Hence, norm should be (in units of $\hbar=1$):
\begin{equation}
||A_{\lambda}||^2 = \sum_n \sum_{m \neq n}  \dfrac{\omega_{nm}^2}{(\omega_{nm}^2 + \mu^2)^2} |\langle m | \partial_{\lambda}H| n \rangle|^2
\end{equation}

Numerically, we find the dependence of gauge potential on $\mu$ using Exact Diagonalization method (ED) in figure \ref{mu_scaling}.

\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.72]{new_pics/v2_norm_mu_scaling.eps} 
\caption{Using ED method, we obtain  $\mu$ dependence of norm of gauge potential in integrable and non-integrable systems}
\label{mu_scaling}
\end{center}
\end{figure}

 Let's claim that $||A||^2/2^L=\alpha\mu^{\beta}$. Then if we take log both sides, we get
\begin{equation}
\log ||A||^2/2^L=\log \alpha+ \beta \log \mu
\end{equation}
where $\beta$ is the slope on a log-log scale. Numerically, we can find $\beta_i$ for each pair of points using the following relationship (figure \ref{beta_mu_scaling}):
\begin{equation}
\beta_i=\dfrac{\log y( \mu_{i+1}) -\log y( \mu_{i})} {\log \mu_{i+1}-\log \mu_{i}}
\end{equation}
where $y= ||A||^2/2^L$. 

\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.43]{new_pics/v3_slope_nonint_semilogx.eps}
\includegraphics[scale=0.52]{new_pics/slope_small_system_nonint.eps}
%\includegraphics[scale=0.7]{new_pics/v2_norm_mu_scaling_nonint.eps}
\caption{Using ED method, we obtain  $\mu$ dependence of negative of slope ($-\beta (\mu)$) for non-integrable systems: a) bigger systems b) smaller systems}
\label{beta_mu_scaling}
\end{center}
\end{figure}
%\begin{figure}[!ht]
%\begin{center}
%%\includegraphics[scale=0.7]{new_pics/v3_slope_nonint_int_compare_semilogx.eps}\\
%\includegraphics[scale=0.7]{new_pics/v3_slope_nonint_semilogx.eps}
%\caption{$\mu$ dependence of negative of slope ($-\beta (\mu)$) is shown for non-integrable systems }
%%\label{slope_nonintegrable_mu}
%\end{center}
%\end{figure}


\subsubsection*{Trivial/non-physical regimes}
 Let's study two regimes we see in the figures: 
\begin{itemize}
\item \textbf{small $\mu$ regime} when $\mu \ll \min\{w_{nm}\}$: Since density of states is highest in the middle of spectrum, $\min\{w_{nm}\}$ is smallest for two states lying there.  In this regime, $\mu$ is so small that it doesn't really affect the norm of gauge potential. So, we get exact gauge potential in this regime.
\begin{equation}
||A_{\lambda}||^2 = \sum_n \sum_{m \neq n}  \dfrac{|\langle m | \partial_{\lambda}H| n \rangle|^2}{\omega_{nm}^2}  \sim 2^Le^L
\end{equation}
Exact gauge potential of non-integrable systems consists of all n- body ($1 \leq n \leq L$) operators. It looks something like:
\begin{equation}
A_{\lambda} = \sum_j [\alpha_j \sigma_j^y + \beta_j ( \sigma_j^y  \sigma_{j+1}^z + \sigma_j^z  \sigma_{j+1}^y ) + \gamma_j ( \sigma_j^y  \sigma_{j+1}^x + \sigma_j^z  \sigma_{j+1}^x ) + \ldots]
\end{equation} 
Looking at the above expression, why norm  of non-integrable systems is exponentially large in system size? My answer, which needs to be discussed with Dries, is that there are only extensive number of operators ($2 L$ in number) as compared to $L$ number of operators in integrable systems. So, the number of operators doesn't make it exponentially large. What makes the big difference is that weight of these operators $\bar{\alpha}_l$ ($ \bar{\alpha}_{l=1}= \{\alpha_j\}, \bar{\alpha}_{l=2}= \{\beta_j\}, \bar{\alpha}_{l=3}=  \{\gamma_j\}$ etc) is exponentially large in string size $l$ which is in contrast with integrable systems, where these weights are exponential suppressed in string size. I should check this for numerically found exact gauge potential.

What's the biggest $\mu$ of this regime? We know that $\min\{w_{nm}\} \simeq e^{-L}$  due to the exponential number of states in a many-body system whose bandwidth generally increases extensively in system size. Hence, we expect $\mu_c^{(1)} \simeq e^{-L}$. 



\item \textbf{big scaling regime} 
When $\mu \gg \max\{w_{nm}\}$, approximate gauge potential $A_{\lambda}^*$ would be given by:
\begin{align*}
A_{\lambda}^* & =  -i \hbar [H,\partial_{\lambda}H ]\dfrac{1}{\mu^2}  \\
& =  -i \hbar \dfrac{1}{\mu^2} C^{(1)}
\end{align*}
where $ C^{(1)}=2i \left(\sum_{j=1}^{L-1} \sigma_j^y \sigma_{j+1}^z + \sum_{j=2}^{L} \sigma_j^y \sigma_{j-1}^z + h \sum_{j=1}^{L}\sigma_j^y \right) $.


\begin{align*}
||A_{\lambda}||^2 &=\dfrac{\alpha}{ \mu^4} \sim\dfrac{L}{ \mu^4} 2^L 
% \dfrac{1}{ \mu^4} \sum_n \sum_{m \neq n}  \omega_{nm}^2 |\langle m | \partial_{\lambda}H| n \rangle|^2 = \dfrac{1}{ \mu^4} \Tr  [H, \partial_{\lambda}H]^2
\end{align*}

where $\alpha=\Tr  [H, \partial_{\lambda}H]^2 $.  For $L=12$, we obtain $\alpha_2^{Th}=119.41$ whose details are given in appendix B.


In this regime, approximate gauge potential is local because it has only a single body term and a two body term. What's the smallest $\mu$ of this regime? We know that $\max\{w_{nm}\} \simeq L$  because bandwidth generally increases extensively in system size. Hence, we expect $\mu_c^{(2)} \simeq L$.
\end{itemize}

These regimes are non-physical because it's not useful to choose $\mu$ either exponentially small (because we will have exact gauge potential which has small denominator problem) or extensively big (because in that case, $\mu$ is the biggest energy scale and then nothing interesting really happens). 

\subsection{Phase diagram of gauge potential }

What we find here is a ``phase diagram" where we get different `types' of gauge potential depending upon the value of $\mu$ used to construct it. Trivial/non-physical regimes are: exact gauge potential in small $\mu$ regime and trivial local approximate gauge potential in big $\mu$ regime.\\
\~ \\


\begin{figure}[!ht]
\begin{center}
\frame{\begin{tikzpicture}[overlay]
\draw [->][red, ultra thick] (2.5,0) --(5.0,0.0);
\draw [-][blue, ultra thick] (-2.5,0) --(-5.0,0.0);
\draw [-][green, ultra thick, dashed] (-2.5,0) --(2.5,0.0);
\draw[black,fill=black] (2.5,0) circle (.5ex);
\draw[black,fill=black] (-2.5,0) circle (.5ex);
\node at (0.0,-0.35) {\huge{\textcolor{black}{?}}};
\node at (5.0,-0.35) {\textcolor{black}{$\mu$}};
\node at (-2.5,-0.35) {\textcolor{black}{$\mu_c^{(1)}(L)=\mu_0^{(1)}e^{-L}$}};
\node at (2.5,-0.35) {\textcolor{black}{$\mu_c^{(2)}(L)=\mu_0^{(2)}L$}};
\node at (-3.5,0.45) {\textcolor{black}{$\dfrac{||A||^2}{2^L}=e^{L}$}};
\node at (3.5,0.45) {\textcolor{black}{$\dfrac{||A||^2}{2^L} \simeq \dfrac{L}{\mu^4}$}};
\node at (0.0,0.45) {\textcolor{black}{$\dfrac{||A||^2}{2^L}=\dfrac{L^{\alpha(\mu,L)}}{\mu^{\beta(\mu, L)}}$}};
\end{tikzpicture}}
\end{center}
\caption{Phase diagram of gauge potential of non-integrable systems as a function of $\mu$}
\end{figure}


In the above picture, the middle part ($ \mu_c^{(1)}(L) < \mu < \mu_c^{(2)}(L)$) still needs to be found out. How does $\alpha$ and $\beta$ depend on $\mu$ and $L$? In order to answer these questions, we need to study more to characterize the different ``phases" for intermediate value of $\mu$ based upon following parameters. For a given phase, we would have a certain range of allowed $\mu$. Within this range of $\mu$,
\begin{itemize}
\item[--] how does the norm of gauge potential varies as a function of system size (L)? Polynomial in L or exponential in L? We know that in exact regime (small $\mu$), it grows as an exponential and in big $\mu$ regime, it grows as linear in system size. What happens in regimes outside these extreme regimes?
\item[--] what kind of operators makes up our gauge potential? We know that in exact regime (small $\mu$), gauge potential consists all all n- body ($1 \leq n \leq L$) operators are there and in big $\mu$ regime, it contains only one and two body operators. What happens in regimes outside these extreme regimes?
\item[--] How does the weight of these operators increase as string length of these operators increase? We know that in exact regime (small $\mu$) for non-integrable model, these weights increase exponentially as the string length increases  and in big $\mu$ regime, the weight is uniform for the one and two body operators. For integrable systems, these weights are exponentially suppressed as the string length increases.  What happens in regimes outside these extreme regimes?
\end{itemize}


We need to figure out a systematic way to find out the boundary of our phase diagram.




\subsection{Finding boundary of phase diagram: system size scaling }

Numerically, we find that norm of exact gauge potential of non-integrable system scale exponentially in system size while it scales as polynomial in system size for integrable system (figure \ref{exact_regime}).
\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.7]{new_pics/v2_1_norm_L_scaling.eps}
\caption{Exact gauge potential as a function of system size: non-integrable systems (exponential scaling) and integrable (polynomial scaling) }
\label{exact_regime}
\end{center}
\end{figure}


\subsubsection*{Scaling of slope of gauge potential}

Here we take different slices in y-axis of slope of gauge potential (figure \ref{mu_scaling}) at certain $\beta_c$. In small $\mu$ regime, since we expect $\beta \simeq 0$, we start off with a value of $\beta_c=10^{-10}$  and then we keep on  increasing our value of $\beta_c$ in subsequent iterations. 

In big $\mu$ regime, since we expect $\beta \simeq 4$, we start off with a value of $\beta_c=3$ and then we keep on decreasing our value of $\beta_c$ in subsequent iterations. 

We find that to reach the same value of $\beta_c$, the system needs cutoff $\mu_c$ whose value is exponentially small in system size in small $\mu$ regime while in big  $\mu$ regime, $\mu_c$ whose value is extensively big in system size (figure \ref{mu_c_1_nonintegrable}). This provides evidence that $\mu_c^{(1)} \propto e^{-L}$ and $\mu_c^{(2)} \propto L$.

\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.45]{new_pics/mu_c_1_nonint.eps}
\includegraphics[scale=0.52]{new_pics/mu_c_2_nonint.eps}
\caption{$\mu_c^{(1)}$ and $\mu_c^{(2)}$ dependence of system size L: former seems exponentially small and the latter a linear one }
\label{mu_c_1_nonintegrable}
\end{center}
\end{figure}



\subsubsection*{Scaling of gauge potential}

In small $\mu$ regime, since we expect $\mu_c^{(1)} \propto e^{-L}$, we parametrize our $\mu_c^{(1)}(L)= \mu_0 e^{-L}$, where $\mu_0$ is our parameter (left side of figure \ref{param_nonintegrable}). Here, we are coming from far left side of phase diagram which means our first guess of $\mu_0$ ($10^{-30}$) is really smaller than $\min{\omega_{ij}}$ and then we will crank up our value of $\mu_0$ in subsequent guesses. In this regime of exact gauge potential, the value of $\mu^0$ and scaling of $\mu$ with system size should not matter. As we increase the value of $\mu_0$, we would find that the value of $\mu$ is big enough that the value of norm of gauge potential is ``appreciably" different than exact gauge potential (when $\mu_0 \sim 10^{-30}$). Since, this change of behavior is continuous \footnote{Is it a crossover phenomenon or  second order phase transition (continuous in order parameter and first derivative of order parameter but discontinuous  in second derivative )?}, it's difficult to exactly determine the boundary of this phase diagram from this approach (maybe I can look into derivative of some order parameter (norm?) and then find a sharper transition?). Hence, from left side of figure \ref{param_nonintegrable}, it's reasonable to claim that $\mu_c^{(1)}= \mu_0^*e^{-L}$, where $\mu_0^*$ lies between 1 and 10.

\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.52]{new_pics/scaling_mu_c_1.eps}
\includegraphics[scale=0.52]{new_pics/scaling_mu_c_2.eps}
\caption{a) \textbf{Scaling of  $\mu_c^{(1)}$:} we parameterize $\mu$ as $\mu_c^{(1)}(L)= \mu_0 e^{-L}$. We find $\mu_0^*$ to be between 1 and 10  b)\textbf{Scaling of $\mu_c^{(2)}$:}  we parameterize $\mu$ as $\mu_c^{(2)}(L)= \mu_0 L$. We find $\mu_0^*$ to be between 10 and 100.  }
\label{param_nonintegrable}
\end{center}
\end{figure}

 
Similarly, in big $\mu$ regime, since we expect $\mu_c^{(2)} \propto L$, we parametrize our $\mu_c^{(2)}(L)= \mu_0 L$, where $\mu_0$ is our parameter. In this regime, we have:
\begin{equation}
||A_{\lambda}||^2= \dfrac{1}{ \mu(L)^4} \Tr  [H, \partial_{\lambda}H]^2
\end{equation}
where $\mu(L)= \mu_0 L$. 

Here, we are coming from far right side of phase diagram which means our first guess of $\mu_0$ ($10^3$) is really bigger than $\max{\omega_{ij}}$ and then we will reduce our value of $\mu_0$ in subsequent guesses. Unlike the regime of exact gauge potential, in this regime of this approximate local gauge potential, the value of $\mu^0$ and scaling of $\mu$ with system size does determine the value of norm of approximate gauge potential. That's why y-axis of right side of figure \ref{param_nonintegrable} has been scaled properly by multiplying norm with $\mu(L)^4$. As we decrease the value of $\mu_0$, we would find that the value of $\mu$ is small enough that the value of norm of gauge potential is ``appreciably" different than local approximate gauge potential (when $\mu_0 \sim 10^3$). Since, this change of behavior is continuous, it's difficult to exactly determine the boundary of this phase diagram from this approach. Hence, from right side of figure \ref{param_nonintegrable}), it's reasonable to claim that $\mu_c^{(2)}= \mu_0^*L$, where $\mu_0^*$, where $\mu_0^*$ lies between 10 and 100.

Before we wind off this section, let's try $\mu_c^{(2)}(L) =\mu_0 L^2$ so as to see what happens if we parametrize with a wrong scaling (figure \ref{param2_nonintegrable}). 


\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.51]{new_pics/scaling_mu_c_2_quad_scaling.eps}
\caption{Scaling of  $\mu_c^{(2)}$: we parameterize $\mu$ as $\mu_c^{(2)}(L)= \mu_0 L^2$. We find $\mu_0^*$ to be between 1 and 10.  }
\label{param2_nonintegrable}
\end{center}
\end{figure}

Can this second analysis on its' own tell us if our system size dependence of critical points ($\mu_c^{(1)}$ and $\mu_c^{(2)}$) is correct? No, we also need to look into the first analysis of slope of gauge potential with respect to $\mu$, which is presented in  figure \ref{mu_c_1_nonintegrable}.

%\subsection{Thouless energy scale}
%
%
%\begin{figure}[!ht]
%\begin{center}
%\includegraphics[scale=0.46]{new_pics/beta_c_1_nonint.eps}
%\includegraphics[scale=0.51]{new_pics/norm_beta_c_1.eps}
%\caption{Scaling of  $\mu_c^{(2)}$: we parameterize $\mu$ as $\mu_c^{(2)}(L)= \mu_0 L^2$. We find $\mu_0^*$ to be between 1 and 10.  }
%\label{param2a_nonintegrable}
%\end{center}
%\end{figure}

\section{Reducing transition and dissipation rate with approximate gauge potential }
Let's try to understand more about $\mu$ by studying transition rate and dissipation rate for a quantum many body systems using Fermi's Golden rule. Let's consider a Hamiltonian:
\begin{equation}
\mathcal{H}_{\mathcal{X}} = \mathcal{H} (\lambda) + \dot{\lambda} \mathcal{X}
\end{equation}
where $\lambda= \lambda_0 + \epsilon(t)$ and  $\epsilon(t)$  is an infinitesimal white noise which satisfies $\overline{ \epsilon(t) \epsilon(t^{\prime})}= \kappa \delta(t -t^{\prime})$ \footnote{If the system is in equilibrium, then fluctuation -dissipation theorem dictates $\kappa = T$}. 
A system under white noise would lead to transitions between all eigenstates. We will see how much there is reduction in transition and dissipation rate with our approximate gauge potential.

We can simplify the above expression:
\begin{equation}
\mathcal{H}_{\mathcal{X}} \approx \mathcal{H} (\lambda_0)+ \epsilon \partial_{\lambda}\mathcal{H} + \dot{\epsilon} \mathcal{X}
\end{equation}
Our expressions will involve $G_{\lambda}$ which is given as $G_{\lambda}(\mathcal{X} )= \partial_{\lambda} H + \dfrac{i}{\hbar} [\mathcal{X}, H] $ where $\mathcal{X}=A_{\lambda}(\mu)$.

\subsection{Transition rate}

Now we would drive the system periodically in addition to the white noise we have in the system. So, in this protocol, time dependence of $\lambda$ is given as $\lambda(t)= \lambda_0 \sin (\omega t) + \epsilon(t)$. We can use Fermi's golden rule (using results from \cite{clerk2010introduction}) to derive  transition rate $\langle \Gamma_n \rangle$ \cite{kolodrubetz2016geometry} as follows: 
\begin{align}
 \Gamma_n (\omega) = \kappa  \sum_{m \neq n} |\langle n | G_{\lambda} | m \rangle |^2 \delta(E_n-E_m- \hbar \omega)
\end{align}
where $\omega$ is frequency of the periodic external drive.   More details  are given in appendix \ref{sec.transition_rate}.

Using the fact that 
$\langle m |A_{\lambda} | n \rangle =  -i \hbar \dfrac{\langle m |\partial_{\lambda}H | n \rangle}{\omega_{mn}^2+ \mu^2} \omega_{mn}$, we find 
\begin{align*}
\langle n | G_{\lambda} | m \rangle &= \langle n |  \partial_{\lambda} H + \dfrac{i}{\hbar} [A_{\lambda}, H]  | m \rangle \\
&= \langle n |  \partial_{\lambda} H | m \rangle + \dfrac{i}{\hbar} \langle n |  [A_{\lambda}, H]  | m \rangle \\
&=   \partial_{\lambda} H^{nm} + \dfrac{i}{\hbar} (E_m-E_n)\langle n | A_{\lambda} | m \rangle \\
&=   \partial_{\lambda} H^{nm}\left(1 -  \dfrac{(E_n-E_m)^2}{(E_n-E_m)^2 + \mu^2} \right)  
\end{align*}

Hence, in units of $\hbar=1$, we have:
 \begin{equation}
 \boxed{
 \Gamma_n (\omega) = \kappa  \sum_{m \neq n} | \partial_{\lambda} H^{nm}|^2 \left(1 -  \dfrac{\omega_{nm}^2}{\omega_{nm}^2 + \mu^2} \right)^2 \delta(\omega_{nm}- \omega)}
\end{equation}
where $\delta$ function is broadened for finite-sized system to include several eigenstates so as to have a smooth dependence of  $\Gamma_n (\omega)$. This means for each $\omega$, we only include the eigenstates in the sum which falls within some tolerance value. We define a tolerance $\epsilon$ as $|\omega- \omega_{nm}|< \epsilon$ to characterize this smoothing procedure. 

In small $\mu$ limit,  $\Gamma_n (\omega)$ is zero for all energy $\omega$. In  $\mu$ is really big, when $A_{\lambda}$ is almost zero, $ G_{\lambda} \approx \partial_{\lambda} H = \sum_i \sigma_i^x$.  This would mean driving the system without any counter-dibatic term. 

\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.53]{new_pics/transition_rate_low_tol.eps}
\includegraphics[scale=0.53]{new_pics/transition_rate_high_tol.eps}
\caption{Transition rate with $\kappa=1$: for L=10, we find that increasing $\mu$ reduces the transition rate across the whole range of energy $\omega$}
\label{L10_transition}
\end{center}
\end{figure}

In small $\mu$ limit,  $\Gamma_n (\omega)$ is zero for all external energy $\omega$ through noise. In  $\mu$ is really big, when $A_{\lambda}$ is almost zero, $ G_{\lambda} \approx \partial_{\lambda} H = \sum_i \sigma_i^x$.  This would mean driving the system using white noise without any counter-dibatic term. 

From figure \ref{L10_transition}, we see that when $\mu > 1$, transition rate is not reducing much for $\omega=0$. Hence, we find that central peak is almost the same while other peaks are reducing a lot. Only when value of $\mu$ is reduced to less than $1$, we find that central peak started reducing. Also, it seems that central peak only starts reducing when other peaks have almost reduced to zero leaving central peak as the only peak in this regime. This should be investigated further.
Can we make a claim that it is in the big $\mu$ regime when central peak  doesn't get reduced whiel other peaks gets reduced substantially? Is there any information in seeing how width scales with $\mu$?



 \subsection{Dissipation rate }
 
 \begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.72]{new_pics/dissipation_rate.eps}
\caption{a) Dissipation rate with $-\kappa=1$: for L=10, we find that increasing $\mu$ reduces the dissipation rate across the whole range of energy $\omega$ b) Average dissipation rate  }
\label{L10_dissipation}
\end{center}
\end{figure}

Dissipation rate $\dfrac{d \sigma^2_E}{dt}$ for a particular eigenstate $ |n \rangle$ is defined as: 

\begin{align}
 \dfrac{d \sigma^2_E}{dt}&= \int d\omega \omega^2 \Gamma_n (\omega)\\
 &=-\kappa \langle n|[G_{\lambda}, H]^2 |n \rangle
\end{align}

After doing some calculations (whose details are given in appendix \ref{sec.dissipation_rate}), we find that:
\begin{equation}
\boxed{
\dfrac{d \sigma^2_E (n)}{dt} =  - \kappa  \sum_{m \neq n}\dfrac{\mu^4 (E_n- E_m)^2}{((E_n-E_m)^2 + \mu^2)^2}  |\langle n |\partial_{\lambda} H |m \rangle|^2}
\end{equation}


\begin{figure}[!ht]
\begin{center}
\includegraphics[scale=0.452]{new_pics/avg_dissipation_rate_2.eps}
\includegraphics[scale=0.452]{new_pics/avg_dissipation_rate.eps}
\caption{ Average dissipation rate a) size-dependence  b) system-size scaled  }
\end{center}
\end{figure}




In small $\mu$ limit,  $ \dfrac{d \sigma^2_E}{dt}$ is zero. In  the regime when $\mu$ is really big, $A_{\lambda}$ is almost zero and  $ G_{\lambda} \approx \partial_{\lambda} H = \sum_i \sigma_i^x$.  This would mean driving the system without any counter-dibatic term. Hence $[G_{\lambda}, H]^2= (C^{(1)}) ^2$ and $\dfrac{d \sigma^2_E}{dt}=-\kappa \langle n|(C^{(1)})^2 |n \rangle $.

Average transition rate is $\delta_E^2/2^L$ where $\delta_E^2$ is given by:

\begin{equation}
\delta_E^2= \sum_{n=1}^{2^L}\dfrac{d \sigma^2_E (n)}{dt}
\end{equation}

\section{Physical meaning of cutoff regulator}
\subsection{Equation of motion for approximate gauge potential}
Equation of motion for exact gauge potential $A_{\lambda}$  is:
\begin{equation}
[H, G_{\lambda}(\mu=0)]=0
\end{equation}
where $G_{\lambda}(\mu=0)= \partial_{\lambda} H + \dfrac{i}{\hbar} [A_{\lambda}, H] $ 



Approximate gauge potential is 
\begin{equation}
 A_{\lambda}(\mu) =  -i\hbar \sum_{n=0}^{\infty}   (-1)^{n} \dfrac{ C^{(2n+1)}}{\mu^{2n+2}}
\end{equation}
where $C^{(n)}$ is n- commutator of $H$ and $\partial_{\lambda} H$, i.e. $C^{(n)}= [H, [H, \mbox{ n times} \ldots,[H, \partial_{\lambda} H ]]] ] $.  We define the first term as $C^{(1)}= [H, \partial_{\lambda}H]$, second term as $C^{(2)}= [H,[H, \partial_{\lambda}H]]= [H, C^{(1)}]$ and so on and forth. Properties of $C^{(n)}$ are noted in appendix \ref{sec.Cn}.

Now, let's  compute:
\begin{align*}
[H, G_{\lambda}(\mu)]&=[H, \partial_{\lambda} H + \dfrac{i}{\hbar} [A_{\lambda}, H]] \\
&= [H, \partial_{\lambda} H] - \dfrac{i}{\hbar} [H,[ H, A_{\lambda}]]\\
&= C^{(1)} + i^2    \sum_{n=0}^{\infty}   (-1)^{n} \dfrac{ C^{(2n+3)}}{\mu^{2n+2}}\\
&= C^{(1)} -  (   \dfrac{ C^{(3)}}{\mu^{2}} - \dfrac{ C^{(5)}}{\mu^{4}} + \ldots)\\
&= C^{(1)} -   \dfrac{ C^{(3)}}{\mu^{2}} + \dfrac{ C^{(5)}}{\mu^{4}} - \ldots\\
&=\sum_{n=0}^{\infty}   (-1)^{n} \dfrac{ C^{(2n+1)}}{\mu^{2n}}\\
&= \dfrac{i}{\hbar} \mu^2 A_{\lambda} (\mu)
\end{align*}
Hence, we get:
 \begin{equation}
 \boxed{[H, \partial_{\lambda} H] + \dfrac{i}{\hbar}[H, [A_{\lambda}(\mu), H]]= \dfrac{i}{\hbar} \mu^2 A_{\lambda} (\mu)}
 \end{equation}
This equation reminds us of the equation wrote by Dries using local gauge potential. We will re-derive his calculations here and see what connections we have.

\begin{equation}
 [\partial_{\lambda} H_S, H_S ] + \dfrac{i}{\hbar}[ [A_{S}, H_S], H_S] + \dfrac{i}{\hbar} \sum_j \gamma_j^2 [[A_{S}, S_j], S_j ]=0
 \end{equation}

Let's rewrite the way we like it:

\begin{align*}
 [ H_S,\partial_{\lambda} H_S ] + \dfrac{i}{\hbar}[ H_S, [A_{S}, H_S]] &= \dfrac{i}{\hbar} \sum_j \gamma_j^2 [[A_{S}, S_j], S_j ]
 \end{align*}


\subsection{Computing local gauge potential }

Approximate gauge potential is 
\begin{equation}
 A_{\lambda}(\mu) =  -i\hbar \sum_{n=0}^{\infty}   (-1)^{n} \dfrac{ C^{(2n+1)}}{\mu^{2n+2}}
\end{equation}

Let's truncate the series by modulating cutoff $\mu_n$ as a function of summation index $n$. This summation index is proportional to lattice index, which means that each higher order of commutator  has bigger support on the lattice, i.e. $C^{(n+1)}$ contains operators which are more spread over lattice than operators in $C^{(n-1)}$. We choose the simplest way to truncate the series by arguing that we have no control over boundary and therefore, cutoff $\mu_n$ should be as follows:

\begin{equation}
  \mu_n=\left\{
  \begin{array}{@{}ll@{}}
   \mu & (\mbox{if } n \leq L), \\
   \infty & (\mbox{if } n > L)
  \end{array}\right.
\end{equation}
This approximation means that $C^{(2n+1)}/\mu^{2n+2}_n \ll 1 $ for $n> L$. As a result, approximate gauge potential after this truncation is: 
\begin{equation}
 A_{\lambda}^{L}(\mu) =  -i\hbar \sum_{n=0}^{L}   (-1)^{n} \dfrac{ C^{(2n+1)}}{\mu^{2n+2}}
\end{equation}
The advantage with this series truncation is that this approximate gauge potential can be obtained without using exact diagonalization; it requires only extensive number of steps while computing the sum. However, we don't know if this approximation is useful at all. Does the norm of this approximate gauge potential is polynomial for all value of $\mu$? Does it reduce dissipation and transition rate for all value of $\mu$? These questions should be investigated numerically.

It's equation of motion is given by (where $L$ is even):
\begin{align*}
[H, G_{\lambda}(\mu)^L]&=[H, \partial_{\lambda} H + \dfrac{i}{\hbar} [A_{\lambda}^L, H]] \\
&= [H, \partial_{\lambda} H] - \dfrac{i}{\hbar} [H,[ H, A_{\lambda}^L]]\\
&= C^{(1)} + i^2    \sum_{n=0}^{L}   (-1)^{n} \dfrac{ C^{(2n+3)}}{\mu^{2n+2}}\\
&= C^{(1)} -  (   \dfrac{ C^{(3)}}{\mu^{2}} - \dfrac{ C^{(5)}}{\mu^{4}} + \ldots - \dfrac{ C^{(2L+1)}}{\mu^{2L}}+ \dfrac{ C^{(2L+3)}}{\mu^{2L+2}} )\\
&= C^{(1)} -   \dfrac{ C^{(3)}}{\mu^{2}} + \dfrac{ C^{(5)}}{\mu^{4}} - \ldots  + \dfrac{ C^{(2L+1)}}{\mu^{2L}} - \dfrac{ C^{(2L+3)}}{\mu^{2L+2}}\\
&=\sum_{n=0}^{L+1}   (-1)^{n} \dfrac{ C^{(2n+1)}}{\mu^{2n}}\\
&= \dfrac{i}{\hbar} \mu^2 A_{\lambda}^{L+1} (\mu)
\end{align*}
This expression is true for both even and odd values of $L$.

Hence, we get:
 \begin{equation}
 \boxed{[H, \partial_{\lambda} H] + \dfrac{i}{\hbar}[H, [A_{\lambda}^{L} (\mu), H]]= \dfrac{i}{\hbar} \mu^2 A_{\lambda}^{L+1} (\mu)}
 \end{equation}
Question that is staring right in our face is whether $ \mu^2 A_{\lambda}^{L+1} (\mu)\stackrel{?}{=} \gamma^2 \sum_j  [[A_{S}, S_j], S_j ]$? In other  words, whether $\mu^2 \stackrel{?}{=} \gamma^2 $ and whether $ A_{\lambda}^{L+1} (\mu)\stackrel{?}{=} \sum_j  [[A_{S}, S_j], S_j ]$? 

Both operators share some common physical features: both operators represent system-boundary interaction terms. If $\mu^2$ or $\gamma^2$ goes to zero, then we have exact gauge potential for the remaining system excluding boundaries. And if $\mu^2$ becomes a really big number, then we know norm of gauge potential is zero. I don't know for sure if  norm of gauge potential goes to zero, if $\gamma^2$ becomes really big.

Dries found that for $\gamma=1$, norm of gauge potential is $L^2$. Let's see what do I get for $\mu=1$. Fingers crossed! 
\appendix
\section{Do degenerate eigenvalues contribute to norm of gauge potential?}\label{sec.deg}
Let's consider $H | n(\lambda) \rangle= E_n  | n(\lambda) \rangle $. Hence, we have $\langle m(\lambda)  |  H | n(\lambda) \rangle=0$ for $n\neq m$. We can exploit this property to get some insight:
\begin{align*}
\partial_{\lambda}\langle m  |  H | n\rangle&=0\\
\langle \partial_{\lambda} m |  H | n \rangle + \langle  m  |  H |\partial_{\lambda} n \rangle + \langle  m  | \partial_{\lambda} H | n \rangle&=0\\
\langle \partial_{\lambda} m   | n \rangle E_n + E_m\langle  m  |   \partial_{\lambda} n \rangle + \langle  m  | \partial_{\lambda} H | n \rangle&=0\\
(E_n - E_m)\langle  \partial_{\lambda} m  |    n \rangle + \langle  m  | \partial_{\lambda} H | n \rangle&=0
\end{align*}

Hence, we find that if there are two degenerate energy levels $n$ and $m$ such that $E_n=E_m$, then $\langle  m  | \partial_{\lambda} H | n \rangle=0$. Hence, the contribution to norm of gauge potential from this pair of energy levels will be zero. I should check this numerically if results of my code respect this property.


\section{Computing $\Tr [H, \partial_{\lambda}H] $}
\subsection{Integrable model}
\begin{equation}
H=  \sum_{j=1}^{L-1} \sigma_j^z \sigma_{j+1}^z + \lambda \sum_{j} \sigma_j^x
\end{equation}
We know that that $\partial_{\lambda}H =  \sum_{j} \sigma_j^x $. Let's denote  $C^{(1)}=[H,\partial_{\lambda}H]$. 


\begin{align*}
[H,\partial_{\lambda}H] & = \sum_{j=1}^{L-1} [\sigma_j^z \sigma_{j+1}^z , \sum_{i} \sigma_i^x]  \\
&= 2i \left(\sum_{j=1}^{L-1} \sigma_j^y \sigma_{j+1}^z + \sum_{j=2}^{L} \sigma_j^y \sigma_{j-1}^z\right)
\end{align*}

We find that $\Tr |C^{(1)}|^2 = 8 (L-1)2^L$ 

\subsection{Non-integrable model}
Non-integrable model's Hamiltonian is given by: 
\begin{equation}
H= J \sum_{j=1}^{L-1} \sigma_j^z \sigma_{j+1}^z + h\sum_{j} \sigma_j^z +\lambda \sum_{j} \sigma_j^x 
\end{equation}
\begin{align*}
[H,\partial_{\lambda}H] & =  [\sum_{j=1}^{L-1} \sigma_j^z \sigma_{j+1}^z + h\sum_{j=1}^{L} \sigma_j^z, \sum_{i} \sigma_i^x]  \\
&= 2i \left(\sum_{j=1}^{L-1} \sigma_j^y \sigma_{j+1}^z + \sum_{j=2}^{L} \sigma_j^y \sigma_{j-1}^z + h \sum_{j=1}^{L}\sigma_j^y \right) 
\end{align*}


We find that $\Tr |C^{(1)}|^2 = 2^L 4(h^2 L + 2J(L-1))$. 
 


\section{details on transition rate}\label{sec.transition_rate}
\begin{align}
 \Gamma_n (\omega) &= \kappa  \sum_{m \neq n} |\langle n | \partial_{\lambda} H - i \omega \mathcal{X} | m \rangle |^2 \delta(E_n-E_m- \omega) \\
 &= \kappa  \sum_{m \neq n} |\langle n | \partial_{\lambda} H - \frac{i}{\hbar} (E_n-E_m)\mathcal{X} | m \rangle |^2 \delta(E_n-E_m- \omega) \\
 &= \kappa  \sum_{m \neq n} |\langle n | \partial_{\lambda} H + \frac{i}{\hbar} (E_m-E_n)\mathcal{X} | m \rangle |^2 \delta(E_n-E_m- \omega) \\
 &= \kappa  \sum_{m \neq n} |\langle n | G_{\lambda} | m \rangle |^2 \delta(E_n-E_m- \omega) \\
\end{align}

\section{details on dissipation rate}\label{sec.dissipation_rate}

\begin{align}
 \dfrac{d \sigma^2_E}{dt}&= \int d\omega \omega^2 \Gamma_n (\omega)\\
  &=\int d\omega \kappa\sum_{m \neq n}  \omega^2 |\langle n | G_{\lambda} | m \rangle |^2 \delta(E_m-E_n- \omega)\\
  &=-\kappa \Tr ([G_{\lambda}, H]^2)
\end{align}

Ignoring $\kappa$ and negative sign, we get:

\begin{align}
\dfrac{d \sigma^2_E}{dt}&=  \langle n |  [G_{\lambda}, H]^2  |    n \rangle  \\
&= \sum_{m} \langle n |  [G_{\lambda}, H]|  m \rangle \langle m |  [G_{\lambda}, H]  |    n \rangle \\
&= \langle n |  [G_{\lambda}, H]|  n \rangle ^2   +   \sum_{m \neq n} \langle n |  [G_{\lambda}, H]|  m \rangle \langle m |  [G_{\lambda}, H]  |    n \rangle \\
&=  \sum_{m \neq n} |\langle n |  [G_{\lambda}, H]|  m \rangle |^2
\end{align}

Now \begin{align*}
 [G_{\lambda}, H]= [\partial_{\lambda} H,H] + \dfrac{i}{\hbar} [[A_{\lambda} , H],H]
\end{align*}
Now let's recall:

\begin{eqnarray}
\langle n | A_{\lambda} | m \rangle &=&  -i \hbar \dfrac{\langle n | \partial_{\lambda}H  | m \rangle}{(E_n-E_m)^2 + \mu^2} (E_n-E_m) \\
&=&  -i \hbar \dfrac{\langle n | [H, \partial_{\lambda} H]  | m \rangle}{(E_n-E_m)^2 + \mu^2} 
\end{eqnarray}
Off-diagonal elements of $[G_{\lambda}, H]$ is given by:
\begin{align}
 [G_{\lambda}, H] &= [\partial_{\lambda} H,H] + \dfrac{i}{\hbar} [[A_{\lambda} , H],H] \\
  &= -[H,\partial_{\lambda} H] - \dfrac{i}{\hbar} [[H,A_{\lambda}],H] \\
    &= -[H,\partial_{\lambda} H] + \dfrac{i}{\hbar} [H,[H,A_{\lambda}]] \\
 &=  -[H,\partial_{\lambda} H] + \dfrac{1}{(E_n-E_m)^2 + \mu^2}  [H,[H, [H, \partial_{\lambda} H]]]
 \end{align}
Hence, we find that :
\begin{align*}
\langle n |  [G_{\lambda}, H]|  m \rangle  &=  - \langle n |[H,\partial_{\lambda} H] |m \rangle +\langle n| \dfrac{1}{(E_n-E_m)^2 + \mu^2}  [H,[H, [H, \partial_{\lambda} H]]] | m\rangle \\
 &=  \left(-(E_n- E_m) + \dfrac{(E_n- E_m)^3}{(E_n-E_m)^2 + \mu^2} \right)  \langle n |\partial_{\lambda} H |m \rangle \\
 &=  -\dfrac{\mu^2 (E_n- E_m)}{(E_n-E_m)^2 + \mu^2}  \langle n |\partial_{\lambda} H |m \rangle \\
\end{align*}
Hence, we get :
\begin{equation}
\boxed{
\dfrac{d \sigma^2_E}{dt} =  - \kappa  \sum_{m \neq n}\dfrac{\mu^4 (E_n- E_m)^2}{((E_n-E_m)^2 + \mu^2)^2}  |\langle n |\partial_{\lambda} H |m \rangle|^2}
\end{equation}


\section{Properties of n-commutators}\label{sec.Cn}
In this section, we would be proving some results of n-commutators $C^{(n)}$.

 
\begin{thm}
$C^{(n)}= [H, C^{(n-1)}],  \forall n>0$ where $C^{(0)}=  \partial_{\lambda}H$ and  $C^{(1)}= [H, \partial_{\lambda}H]$
\end{thm}
\begin{proof}
We define the first two terms  as $C^{(0)}=  \partial_{\lambda}H$ and $C^{(1)}= [H, \partial_{\lambda}H]$. 


Now, $C^{(2)}= [H,[H, \partial_{\lambda}H]]= [H, C^{(1)}]$. Similarly, $C^{(3)}=  [H, C^{(2)}]$. Hence, we can claim using induction argument:
\begin{equation}
C^{(n)}= [H, C^{(n-1)}]
\end{equation}
\end{proof}
 


\section{Integrable systems with open boundary condition}

Here I show that for integrable systems with open boundary conditions, we find some kind of structure, which is absent when computed using periodic boundary conditions.

\begin{figure}[ht!]
\begin{center}
\includegraphics[scale=0.5]{new_pics/v3_slope_int_semilogx.eps} 
\includegraphics[scale=0.5]{new_pics/v3_slope_int_semilogx_zoom.eps}
\caption{$\mu$ dependence of negative of slope ($-\beta (\mu)$) is shown for  integrable systems }
\label{slope_integrable_mu}
\end{center}
\end{figure}

If there is degeneracy, $\min \omega_{ij}(L)$ should be zero. Why don't I see any degenerate level?

I find that because of open boundary conditions, I don't get any degenerate states for integrable model\footnote{Can I see this analytically for a simple model with only $J \sum_i\sigma_{i+1}^z \sigma_{i}^z$ term?}. The question is then how do I get an almost linear scaling of norm for integrable models? We had reasoned that $\langle n| \partial_{\lambda} H|m\rangle$ is zero because of extensive number of degenerate levels. It doesn't seem like that here.
Notes on how to find error in fitting using least-square method in python \footnote{a) https://stackoverflow.com/questions/14854339/in-scipy-how-and-why-does-curve-fit-calculate-the-covariance-of-the-parameter-es b) https://stackoverflow.com/questions/14581358/getting-standard-errors-on-fitted-parameters-using-the-optimize-leastsq-method-i }

\bibliography{ref} 

\bibliographystyle{unsrt}
%\bibliographystyle{plain}

\end{document}
